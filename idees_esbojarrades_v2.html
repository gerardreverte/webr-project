<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gerard Reverté">

<title>Idees esbojarrades</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="idees_esbojarrades_v2_files/libs/clipboard/clipboard.min.js"></script>
<script src="idees_esbojarrades_v2_files/libs/quarto-html/quarto.js"></script>
<script src="idees_esbojarrades_v2_files/libs/quarto-html/popper.min.js"></script>
<script src="idees_esbojarrades_v2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="idees_esbojarrades_v2_files/libs/quarto-html/anchor.min.js"></script>
<link href="idees_esbojarrades_v2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="idees_esbojarrades_v2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="idees_esbojarrades_v2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="idees_esbojarrades_v2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="idees_esbojarrades_v2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="idees_esbojarrades_v2_files/libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="idees_esbojarrades_v2_files/libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet">
<script type="module" src="idees_esbojarrades_v2_files/libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="idees_esbojarrades_v2_files/libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Taula de continguts</h2>
   
  <ul>
  <li><a href="#idees" id="toc-idees" class="nav-link active" data-scroll-target="#idees">Idees</a>
  <ul class="collapse">
  <li><a href="#creació-de-dades-sintètiques-de-la-renda" id="toc-creació-de-dades-sintètiques-de-la-renda" class="nav-link" data-scroll-target="#creació-de-dades-sintètiques-de-la-renda">1. Creació de dades sintètiques de la renda</a>
  <ul class="collapse">
  <li><a href="#què-vull-aconseguir" id="toc-què-vull-aconseguir" class="nav-link" data-scroll-target="#què-vull-aconseguir"><strong>Què vull aconseguir?</strong></a></li>
  <li><a href="#com-fer-ho" id="toc-com-fer-ho" class="nav-link" data-scroll-target="#com-fer-ho"><strong>Com fer-ho?</strong></a></li>
  <li><a href="#exemple-edat-de-la-població-de-mataró" id="toc-exemple-edat-de-la-població-de-mataró" class="nav-link" data-scroll-target="#exemple-edat-de-la-població-de-mataró"><strong>Exemple: edat de la població de Mataró</strong></a></li>
  <li><a href="#com-ho-podem-fer-amb-la-renda" id="toc-com-ho-podem-fer-amb-la-renda" class="nav-link" data-scroll-target="#com-ho-podem-fer-amb-la-renda"><strong>Com ho podem fer amb la renda?</strong></a></li>
  <li><a href="#el-perquè-daquest-projecte" id="toc-el-perquè-daquest-projecte" class="nav-link" data-scroll-target="#el-perquè-daquest-projecte"><strong>El perquè d’aquest projecte</strong></a></li>
  </ul></li>
  <li><a href="#previsió-de-sèries-temporals" id="toc-previsió-de-sèries-temporals" class="nav-link" data-scroll-target="#previsió-de-sèries-temporals">2. Previsió de sèries temporals</a>
  <ul class="collapse">
  <li><a href="#el-meu-pla" id="toc-el-meu-pla" class="nav-link" data-scroll-target="#el-meu-pla">El meu pla</a></li>
  <li><a href="#com" id="toc-com" class="nav-link" data-scroll-target="#com">Com?</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Idees esbojarrades</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Gerard Reverté </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="idees" class="level1">
<h1>Idees</h1>
<ol type="1">
<li><p>Creació de dades sintètiques de la renda a nivell municipal o fins i tot inferior</p></li>
<li><p>Previsió de sèries temporals</p></li>
</ol>
<section id="creació-de-dades-sintètiques-de-la-renda" class="level2">
<h2 class="anchored" data-anchor-id="creació-de-dades-sintètiques-de-la-renda">1. Creació de dades sintètiques de la renda</h2>
<section id="què-vull-aconseguir" class="level3">
<h3 class="anchored" data-anchor-id="què-vull-aconseguir"><strong>Què vull aconseguir?</strong></h3>
<p>El que vull és aconseguir és generar microdades de la renda de les persones residents als municipis o a les seccions censals.</p>
</section>
<section id="com-fer-ho" class="level3">
<h3 class="anchored" data-anchor-id="com-fer-ho"><strong>Com fer-ho?</strong></h3>
<p>Generant dades sintètiques. Les dades sintètiques, són dades inventades, dades que no existeixen a la realitat i es generen a través d’un algoritme. En el cas de la renda el que es busca és crear dades que segueixin una distribució molt similar a les dades de la renda.</p>
</section>
<section id="exemple-edat-de-la-població-de-mataró" class="level3">
<h3 class="anchored" data-anchor-id="exemple-edat-de-la-població-de-mataró"><strong>Exemple: edat de la població de Mataró</strong></h3>
<div>
<div id="webr-1" class="exercise-cell">

</div>
<script type="webr-1-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoibGlicmFyeShvcGVueGxzeCwgcXVpZXRseSA9IFRSVUUpXG5saWJyYXJ5KGZpdGRpc3RycGx1cywgcXVpZXRseSA9IFRSVUUpIFxubGlicmFyeShnZ3Bsb3QyLCBxdWlldGx5ID0gVFJVRSlcbmxpYnJhcnkodGljdG9jLCBxdWlldGx5ID0gVFJVRSlcbmxpYnJhcnkod2ViciwgcXVpZXRseSA9IFRSVUUpXG5saWJyYXJ5KGd0LCBxdWlldGx5ID0gVFJVRSlcblxudXJsIDwtIFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2dlcmFyZHJldmVydGUvZGFkZXMvbWFpbi9lZGF0Lnhsc3hcIlxuZGVzdGZpbGUgPC0gXCJlZGF0Lnhsc3hcIlxuXG4jIERlc2NhcnJlZ2FyIGVsIGZpdHhlclxuZG93bmxvYWQuZmlsZSh1cmwsIGRlc3RmaWxlLCBtb2RlID0gXCJ3YlwiKSAgIyBcIndiXCIgcGVyIGEgZml0eGVycyBiaW5hcmlzIGNvbSBFeGNlbFxuXG4jIExsZWdlaXggZWwgZml0eGVyIEV4Y2VsXG5tYXRhcm8gPC0gcmVhZC54bHN4KGRlc3RmaWxlKVxuXG5oZWFkKG1hdGFybylcblxuZ2dwbG90KG1hdGFybywgYWVzKHggPSBFZGF0KSkgK1xuICBnZW9tX2hpc3RvZ3JhbShiaW5zID0gNTApICtcbiAgZ2d0aXRsZShcIkhpc3RvZ3JhbWEgZGUgbCdlZGF0IGRlIGxhIHBvYmxhY2nDsyBkZSBNYXRhcsOzXCIpICtcbiAgbGFicyh4ID0gXCJFZGF0XCIsIHkgPSBcIk5vbWJyZVwiKSArXG4gIHRoZW1lKFxuICAgIHBsb3QudGl0bGUgPSBlbGVtZW50X3RleHQoXG4gICAgICBmYWNlID0gXCJib2xkXCIsICAgICAgIyBOZWdyZXRhXG4gICAgICBzaXplID0gMTYsICAgICAgICAgICMgTWlkYSBkZSBsYSBmb250XG4gICAgICBoanVzdCA9IDAuNSAgICAgICAgICMgQ2VudHJhdCBob3JpdHpvbnRhbG1lbnRcbiAgICApXG4gIClcblxuZ2dwbG90KG1hdGFybywgYWVzKHggPSBFZGF0KSkgK1xuICBnZW9tX2RlbnNpdHkoY29sb3IgPSBcInJlZFwiLCBmaWxsID0gXCJyZWRcIiwgYWxwaGEgPSAwLjMsIGxpbmV3aWR0aCA9IDEpICtcbiAgZ2d0aXRsZShcIkZ1bmNpw7MgZGUgZGVuc2l0YXQgZGUgbCdlZGF0IGRlIGxhIHBvYmxhY2nDsyBkZSBNYXRhcsOzXCIsKSArXG4gIGxhYnMoeCA9IFwiRWRhdFwiLCB5ID0gXCJEZW5zaXRhdFwiKSArXG4gIHRoZW1lKFxuICAgIHBsb3QudGl0bGUgPSBlbGVtZW50X3RleHQoXG4gICAgICBmYWNlID0gXCJib2xkXCIsICAgICAgIyBOZWdyZXRhXG4gICAgICBzaXplID0gMTYsICAgICAgICAgICMgTWlkYSBkZSBsYSBmb250XG4gICAgICBoanVzdCA9IDAuNSAgICAgICAgICMgQ2VudHJhdCBob3JpdHpvbnRhbG1lbnRcbiAgICApXG4gICkifQ==
</script>
</div>
<div>
<div id="webr-2" class="exercise-cell">

</div>
<script type="webr-2-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiIyBQYXJhbWV0ZXJzIGZvciB0aGUgRXhwb25lbnRpYWwtR2FtbWEgbWl4dHVyZSBtb2RlbFxucCA8LSAwLjMwNzI4NjY1MjMxNTQ0MDRcbmxhbWJkYSA8LSAwLjA1NDM0MTQ4NTg5ODQ5NzJcbmEgPC0gNy45MDIwMzI4MTQ3Nzc1NThcbnNjYWxlX2cgPC0gNi4zNTg1NzExOTcxOTM2MTVcblxuIyBGdW5jdGlvbiB0byBnZW5lcmF0ZSByYW5kb20gdmFsdWVzIGZyb20gdGhlIEV4cG9uZW50aWFsLUdhbW1hIG1peHR1cmUgbW9kZWxcbmdlbmVyYXRlX2V4cG9uZW50aWFsX2dhbW1hIDwtIGZ1bmN0aW9uKG4sIHAsIGxhbWJkYSwgYSwgc2NhbGVfZykge1xuICBzYW1wbGVzIDwtIG51bWVyaWMobilcbiAgZm9yIChpIGluIDE6bikge1xuICAgIGlmIChydW5pZigxKSA8IHApIHtcbiAgICAgICMgR2VuZXJhdGUgZnJvbSBFeHBvbmVudGlhbFxuICAgICAgc2FtcGxlc1tpXSA8LSByZXhwKDEsIHJhdGUgPSBsYW1iZGEpXG4gICAgfSBlbHNlIHtcbiAgICAgICMgR2VuZXJhdGUgZnJvbSBHYW1tYVxuICAgICAgc2FtcGxlc1tpXSA8LSByZ2FtbWEoMSwgc2hhcGUgPSBhLCBzY2FsZSA9IHNjYWxlX2cpXG4gICAgfVxuICB9XG4gIHJldHVybihzYW1wbGVzKVxufVxuXG4jIEdlbmVyYXRlIHJhbmRvbSB2YWx1ZXMgKGUuZy4sIDEyNDkzNCB2YWx1ZXMpXG5zZXQuc2VlZCgxMjMpICAjIEZvciByZXByb2R1Y2liaWxpdHlcbnJhbmRvbV92YWx1ZXMgPC0gZ2VuZXJhdGVfZXhwb25lbnRpYWxfZ2FtbWEoMTI0OTM0LCBwLCBsYW1iZGEsIGEsIHNjYWxlX2cpXG5yYW5kb21fdmFsdWVzX2RmIDwtIGRhdGEuZnJhbWUoRWRhdCA9IHJhbmRvbV92YWx1ZXMpXG5oZWFkKHJhbmRvbV92YWx1ZXNfZGYpXG5cbiMgUGxvdCB0aGUgaGlzdG9ncmFtIGZvciB2aXN1YWxpemF0aW9uXG5nZ3Bsb3QocmFuZG9tX3ZhbHVlc19kZiwgYWVzKHggPSBFZGF0KSkgK1xuICBnZW9tX2hpc3RvZ3JhbShiaW5zID0gNTApICtcbiAgZ2d0aXRsZShcIkhpc3RvZ3JhbWEgZGUgZGFkZXMgc2ludMOodGlxdWVzIGRlIGwnZWRhdCBcXG5kZSBsYSBwb2JsYWNpw7MgZGUgTWF0YXLDs1wiKSArXG4gIGxhYnMoeCA9IFwiRWRhdCAoc2ludMOodGljYSlcIiwgeSA9IFwiTm9tYnJlXCIpICtcbiAgdGhlbWUoXG4gICAgcGxvdC50aXRsZSA9IGVsZW1lbnRfdGV4dChcbiAgICAgIGZhY2UgPSBcImJvbGRcIiwgICAgICAjIE5lZ3JldGFcbiAgICAgIHNpemUgPSAxNiwgICAgICAgICAgIyBNaWRhIGRlIGxhIGZvbnRcbiAgICAgIGhqdXN0ID0gMC41ICAgICAgICAgIyBDZW50cmF0IGhvcml0em9udGFsbWVudFxuICAgIClcbiAgKSJ9
</script>
</div>
<p><span class="math display">\[
f(x) =
\begin{cases}
p \cdot \lambda e^{-\lambda x}, &amp; \text{si } x \sim \text{Exponencial}(\lambda), \\
(1 - p) \cdot \frac{x^{a-1} e^{-\frac{x}{\text{scale}_g}}}{\Gamma(a) \cdot \text{scale}_g^a}, &amp; \text{si } x \sim \text{Gamma}(a, \text{scale}_g).
\end{cases}
\]</span></p>
<section id="combina-les-dades-originals-i-generades-en-un-sol-data-frame" class="level4">
<h4 class="anchored" data-anchor-id="combina-les-dades-originals-i-generades-en-un-sol-data-frame">Combina les dades originals i generades en un sol data frame</h4>
<div>
<div id="webr-3" class="exercise-cell">

</div>
<script type="webr-3-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZGFkZXNfb3JpZ2luYWxzIDwtIGRhdGEuZnJhbWUoZWRhdCA9IG1hdGFybyRFZGF0LCBmb250ID0gXCJvcmlnaW5hbFwiKVxuZGFkZXNfZ2VuZXJhZGVzIDwtIGRhdGEuZnJhbWUoZWRhdCA9IHJhbmRvbV92YWx1ZXMsIGZvbnQgPSBcInNpbnTDqHRpY2FcIilcbmNvbWJpbmVkX2RhdGEgPC0gcmJpbmQoZGFkZXNfb3JpZ2luYWxzLGRhZGVzX2dlbmVyYWRlcylcblxuIyMjIyBDcmVhIGVsIGdyw6BmaWMgYW1iIGdncGxvdDJcblxuZ2dwbG90KGNvbWJpbmVkX2RhdGEsIGFlcyh4ID0gZWRhdCwgZmlsbCA9IGZvbnQpKSArIFxuICBnZW9tX2hpc3RvZ3JhbShwb3NpdGlvbiA9IFwiaWRlbnRpdHlcIiwgYWxwaGEgPSAwLjUsIGJpbnMgPSA1MCkgK1xuICBsYWJzKHRpdGxlID0gXCJDb21wYXJhY2nDsyBlbnRyZSBkYWRlcyBvcmlnaW5hbHMgaSBzaW50w6h0aXF1ZXNcIiwgeCA9IFwiRWRhdFwiLCB5ID0gXCJIYWJpdGFudHNcIikgKyBcbiAgc2NhbGVfZmlsbF9tYW51YWwodmFsdWVzID0gYyhcIm9yaWdpbmFsXCIgPSBcImJsdWVcIiwgXCJzaW50w6h0aWNhXCIgPSBcIm9yYW5nZVwiKSkgKyBcbiAgdGhlbWUoXG4gICAgcGxvdC50aXRsZSA9IGVsZW1lbnRfdGV4dChcbiAgICAgIGZhY2UgPSBcImJvbGRcIiwgICAgICAjIE5lZ3JldGFcbiAgICAgIHNpemUgPSAxNiwgICAgICAgICAgIyBNaWRhIGRlIGxhIGZvbnRcbiAgICAgIGhqdXN0ID0gMC41ICAgICAgICAgIyBDZW50cmF0IGhvcml0em9udGFsbWVudFxuICAgIClcbiAgKSJ9
</script>
</div>
<div>
<div id="webr-4" class="exercise-cell">

</div>
<script type="webr-4-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiY29tcGFyYXRpdmEgPC0gZGF0YS5mcmFtZShpbmRpY2Fkb3IgPSBjKFwibWl0amFuYVwiLFwiZGVzdmlhY2nDsyB0w61waWNhXCIsXCJtZWRpYW5hXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbCA9IGMobWVhbihkYWRlc19vcmlnaW5hbHMkZWRhdCksIHNkKGRhZGVzX29yaWdpbmFscyRlZGF0KSxxdWFudGlsZShkYWRlc19vcmlnaW5hbHMkZWRhdCwgMC41KSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNpbnRldGljYSA9IGMobWVhbihkYWRlc19nZW5lcmFkZXMkZWRhdCksIHNkKGRhZGVzX2dlbmVyYWRlcyRlZGF0KSwgIHF1YW50aWxlKGRhZGVzX2dlbmVyYWRlcyRlZGF0LCAwLjUpKSlcblxuIyBEb25hciBmb3JtYXQgYSBsYSB0YXVsYSBhbWIgZ3RcbmNvbXBhcmF0aXZhICU+JVxuICBndCgpICU+JVxuICB0YWJfaGVhZGVyKFxuICAgIHRpdGxlID0gXCJDb21wYXJhdGl2YSBkJ2luZGljYWRvcnNcIixcbiAgICBzdWJ0aXRsZSA9IFwiRGFkZXMgb3JpZ2luYWxzIHZzIHNpbnTDqHRpcXVlc1wiXG4gICkgJT4lXG4gIGZtdF9udW1iZXIoXG4gICAgY29sdW1ucyA9IGMob3JpZ2luYWwsIHNpbnRldGljYSksXG4gICAgZGVjaW1hbHMgPSAyXG4gICkgJT4lXG4gIGNvbHNfbGFiZWwoXG4gICAgaW5kaWNhZG9yID0gXCJJbmRpY2Fkb3JcIixcbiAgICBvcmlnaW5hbCA9IFwiT3JpZ2luYWxcIixcbiAgICBzaW50ZXRpY2EgPSBcIlNpbnTDqHRpY2FcIlxuICApICU+JVxuICB0YWJfc3R5bGUoXG4gICAgc3R5bGUgPSBsaXN0KGNlbGxfdGV4dCh3ZWlnaHQgPSBcImJvbGRcIikpLFxuICAgIGxvY2F0aW9ucyA9IGNlbGxzX2NvbHVtbl9sYWJlbHMoZXZlcnl0aGluZygpKVxuICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICJ9
</script>
</div>
</section>
<section id="montecarlo" class="level4">
<h4 class="anchored" data-anchor-id="montecarlo">Montecarlo</h4>
<div>
<div id="webr-5" class="exercise-cell">

</div>
<script type="webr-5-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZWRhdCA8LSBkYXRhLmZyYW1lKCkgXG5mb3IoaSBpbiAxOjIwKXsgXG4gIGVkYXRfYWxlYXRvcmlhIDwtIGdlbmVyYXRlX2V4cG9uZW50aWFsX2dhbW1hKDEyNDkzNCwgcCwgbGFtYmRhLCBhLCBzY2FsZV9nKSBcbiAgZWRhdFtpLDFdIDwtIG1lYW4oZWRhdF9hbGVhdG9yaWEpIFxuICB9XG5cbiMgQ2FsY3VsYSBlbHMgaW50ZXJ2YWxzXG5pbnRlcnZhbF9lZGF0IDwtIGRhdGEuZnJhbWUoXG4gIFBlcmNlbnRpbCA9IGMoXCIyLjUlXCIsIFwiOTcuNSVcIiksXG4gIFZhbG9yID0gcXVhbnRpbGUoZWRhdFssIDFdLCBwcm9icyA9IGMoMC4wMjUsIDAuOTc1KSlcbilcblxuaW50ZXJ2YWxfZWRhdCAlPiVcbiAgZ3QoKSAlPiVcbiAgdGFiX2hlYWRlcihcbiAgICB0aXRsZSA9IFwiSW50ZXJ2YWwgZGUgY29uZmlhbsOnYSBkZSBsZXMgZGFkZXMgc2ludMOodGlxdWVzIGRlIGwnZWRhdFwiLFxuICAgIHN1YnRpdGxlID0gXCJQZXJjZW50aWxzIDIuNSUsIDk3LjUlXCJcbiAgKSAlPiVcbiAgZm10X251bWJlcihcbiAgICBjb2x1bW5zID0gVmFsb3IsXG4gICAgZGVjaW1hbHMgPSAyXG4gICkgJT4lXG4gIGNvbHNfbGFiZWwoXG4gICAgUGVyY2VudGlsID0gXCJQZXJjZW50aWxcIixcbiAgICBWYWxvciA9IFwiVmFsb3JcIlxuICApICU+JVxuICB0YWJfc3R5bGUoXG4gICAgc3R5bGUgPSBsaXN0KGNlbGxfdGV4dCh3ZWlnaHQgPSBcImJvbGRcIikpLFxuICAgIGxvY2F0aW9ucyA9IGNlbGxzX2NvbHVtbl9sYWJlbHMoZXZlcnl0aGluZygpKVxuICApXG5cblxucHJpbnQocGFzdGUoXCJMJ2VkYXQgbWl0amFuYSBkZSBNYXRhcsOzIMOpcyBkZVwiLCByb3VuZChtZWFuKGRhZGVzX29yaWdpbmFscyRlZGF0KSwyKSkpIn0=
</script>
</div>
</section>
</section>
<section id="com-ho-podem-fer-amb-la-renda" class="level3">
<h3 class="anchored" data-anchor-id="com-ho-podem-fer-amb-la-renda"><strong>Com ho podem fer amb la renda?</strong></h3>
<p>Cal tenir present que la renda habitualment pot seguir les següents funcions de distribució:</p>
<ul>
<li><p>Paretto</p></li>
<li><p>Weibull</p></li>
<li><p>Gamma</p></li>
</ul>
<section id="pla-a" class="level4">
<h4 class="anchored" data-anchor-id="pla-a">Pla A</h4>
<p>Fer una petició a l’INE demanant la funció de distribució de la renda i els paràmetres dels 314 municipis de la província de Barcelona</p>
<ul>
<li><p><strong>Pros:</strong> tenir la distribució de cada municipi a partir de les dades originals de cada municipi</p></li>
<li><p><strong>Contra:</strong></p>
<ol type="1">
<li><p>Cost</p></li>
<li><p>Temps</p></li>
</ol></li>
</ul>
</section>
<section id="pla-b" class="level4">
<h4 class="anchored" data-anchor-id="pla-b">Pla B</h4>
<p>Fer una “estimació” de la funció de distribució de la renda de cada municipi i dels seus paràmetres. Com?</p>
<ol type="1">
<li><p>Fer una petició a l’INE demanant la funció de distribució de la renda i els paràmetres de les 50 províncies.</p>
<ul>
<li><strong>Contra</strong>: cost econòmic (inferior al de demanar els 314 municipis de la província de Barcelona); temps (no sabem quan trigaran a donar aquesta informació, però segur que és inferior a la de demanar els 314 municipis de la província de Barcelona).</li>
</ul></li>
<li><p>Fer un model que permeti “estimar” la funció de distribució de la renda de les províncies a partir de variables explicatives provincials procedents de l’atles de la renda de l’INE.</p>
<p>Les variables explicatives del model han d’estar disponibles també a nivell municipal o de secció censal.</p>
<p><span class="math inline">\(Pareto(Albacete) = \hat\beta_0 + \hat\beta_1 \cdot \text{Renda mitjana}_{Albacete} + \hat\beta_2 \cdot \text{renda mediana}_{Albacete} + ...+ {\large \epsilon_{Albacete}}\)</span></p>
<p><span class="math inline">\(Pareto(Àlaba) = \hat\beta_0 + \hat\beta_1 \cdot \text{Renda mitjana}_{Àlaba} + \hat\beta_2 \cdot \text{renda mediana}_{Àlaba} + ...+ {\large \epsilon_{Àlaba}}\)</span></p>
<p><span class="math inline">\(Pareto(Alacant) = \hat\beta_0 + \hat\beta_1 \cdot \text{Renda mitjana}_{Alacant} + \hat\beta_2 \cdot \text{renda mediana}_{Alacant} + ...+ {\large \epsilon_{Alacant}}\)</span></p>
<p><span class="math inline">\(Pareto(Barcelona) = \hat\beta_0 + \hat\beta_1 \cdot \text{Renda mitjana}_{Barcelona} + \hat\beta_2 \cdot \text{renda mediana}_{Barcelona} + ...+ {\large \epsilon_{Barcelona}}\)</span></p>
<p>…</p>
<p>…</p>
<p>…</p>
<p>… <span class="math inline">\(Pareto(Saragossa) = \hat\beta_0 + \hat\beta_1 \cdot \text{Renda mitjana}_{Saragossa} + \hat\beta_2 \cdot \text{renda mediana}_{Saragossa} + ...+ {\large \epsilon_{Saragossa}}\)</span></p></li>
<li><p>Utilitzar els valors dels coeficients <span class="math inline">\(\hat\beta_0\)</span>, <span class="math inline">\(\hat\beta_1\)</span>, <span class="math inline">\(\hat\beta_2\)</span>,…, <span class="math inline">\(\hat\beta_n\)</span> i aplicar-ho a les variables explicatives dels municipis o seccions censals.</p>
<p><span class="math inline">\(\hat\beta_0 + \hat\beta_1 \cdot \text{Renda mitjana}_{Sitges} + \hat\beta_2 \cdot \text{renda mediana}_{Sitges} + ... \rightarrow \widehat{\text{Pareto}}(\text{Sitges})\)</span></p>
<p><span class="math inline">\(\hat\beta_0 + \hat\beta_1 \cdot \text{Renda mitjana}_{Granollers} + \hat\beta_2 \cdot \text{renda mediana}_{Granollers} + ... \rightarrow \widehat{\text{Pareto}}(\text{Granollers})\)</span></p>
<p><span class="math inline">\(\hat\beta_0 + \hat\beta_1 \cdot \text{Renda mitjana}_{Vic} + \hat\beta_2 \cdot \text{renda mediana}_{Vic} + ... \rightarrow \widehat{\text{Pareto}}(\text{Vic})\)</span></p></li>
<li><p>Un cop tens la funció de distribució estimada de la renda del municipi es poden generar variables aleatòries que siguin de la mida del nombre d’habitants del municipi (o dels majors de 16 del municipi) com he fet amb les dades de l’edat.</p></li>
</ol>
<ul>
<li><p><strong>Pros:</strong> permetrà personalitzar el llindar de pobresa (o de riquesa) o permetrà calcular indicadors a mida.</p></li>
<li><p><strong>Contra:</strong></p>
<ul>
<li><p>no sé si és factible un model en el que la variable explicada estigui configurada per diferents valors (els paràmetres de la funció).</p>
<p>En un model de regressió hi ha una variable explicada (que conté un valor per cada cas) vs diferents variables explicatives.</p>
<p>En la meva proposta la variable explicada és una funció, la qual habitualment conté diferents valors corresponents als diferents paràmetres que configuren la funció, i no sé si això és possible.</p>
<p><span style="color: red;">IDEA: es podria entrenar a ChatGPT?</span></p></li>
<li><p>En el cas que el punt anterior fos factible, no sé si les variables explicatives que hi ha a l’Atles de distribució de la renda de l’INE seran suficients per aconseguir un model amb poc error.</p>
<p>Recordar que es necessita que les variables que s’utilitzen a nivell de la província han d’estar disponibles a nivell del municipi o de la secció censal.</p></li>
</ul></li>
</ul>
</section>
<section id="pla-c" class="level4">
<h4 class="anchored" data-anchor-id="pla-c">Pla C</h4>
<p>Fer una “estimació” de la funció de distribució de la renda de cada municipi i dels seus paràmetres. Com?</p>
<ol type="1">
<li><p>Utilitzar les microdades de l’INE de l’enquesta de condicions de vida d’on s’estima la renda que s’utilitza i segueix els criteris de l’Eurostat.</p>
<p>Cal tenir present que les dades de l’enquesta de condicions de vida té desagregació a nivell de comunitat autònoma.</p>
<p>De l’enquesta de condicions de vida s’ha d’extreure la funció de distribució de la renda de cada comunitat autònoma amb els respectius paràmetres.</p></li>
<li><p>Aplicar els punts del 2 al 4 del <strong>pla B</strong>.</p></li>
</ol>
<p>Els <strong>Pros</strong> i <strong>Contra</strong> seran els mateixos que els del <strong>pla B</strong>, amb l’afegit que no tinc clar que el càlcul de la renda de l’enquesta de condicions de vida sigui igual o similar a la de l’Atles de distribució de la renda.</p>
</section>
<section id="pla-d" class="level4">
<h4 class="anchored" data-anchor-id="pla-d">Pla D</h4>
<p>Carregar a ChatGPT totes les variables dels municipis de la província de Barcelona de l’Atles de distribució de la renda de l’INE, i dir-li que són dades de renda i que sabem que segueixen una distribució de Paretto, i que volem que ens digui per cada municipi quins són els paràmetres de la distribució de Paretto a partir de les dades que li hem donat.</p>
</section>
</section>
<section id="el-perquè-daquest-projecte" class="level3">
<h3 class="anchored" data-anchor-id="el-perquè-daquest-projecte"><strong>El perquè d’aquest projecte</strong></h3>
<p>En primer lloc, el fet d’obtenir microdades sintètiques de la renda de cada municipi, i si és possible de cada secció censal, ens permetrà calcular indicadors a mida.</p>
<p>Exemples:</p>
<ul>
<li><p>Quanta gent està del municipi X està per sota del llindar del 60% de la mediana de la província de Barcelona (o de l’àrea metropolitana de Barcelona)?</p></li>
<li><p>Quin percentatge de la població ha de destinar més d’un 33% de la seva renda a la compra d’un habitatge al municipi X?</p></li>
</ul>
<p>En segon lloc, aquest projecte és un repte. Fins on jo sé a ningú ha generat dades sintètiques de la renda a partir de les dades de l’Atles de distribució de la renda, i crec que la proposta és innovadora.</p>
<p>Potser en el desenvolupament del projecte ens n’adonem que no és factible aconseguir-ho. Però si aconseguim resultats positius, a la XODEL ens donaria més visibilitat.</p>
</section>
</section>
<section id="previsió-de-sèries-temporals" class="level2">
<h2 class="anchored" data-anchor-id="previsió-de-sèries-temporals">2. Previsió de sèries temporals</h2>
<p>Tot va començar amb aquest article: <a href="https://www.perfilciutat.net/articles/data-lake-o-data-warehouse">Data Lake o Data Warehouse?</a></p>
<p>I més concretament d’aquest paràgraf</p>
<p><img src="datalake_o_datawarehouse.jpg" class="img-fluid"></p>
<p>Llegint-ho aquest paràgraf dóna la sensació que sé de que parlo del tema d’algoritmes per fer previsió de sèries temporals, però en realitat no en tinc ni idea. M’interessa el tema, però en sé el just, sé el mínim de models ARIMA.</p>
<p>Aquests algoritmes que anomeno a l’article els trec d’aquest altre article de Medium:</p>
<p><a href="https://medium.com/@ycwong.joe/a-brief-history-of-time-series-models-38455c2cd78d"><strong>A brief history of time series models</strong></a></p>
<p>És un article escrit al 2022, però que es va actualitzant amb els nous algoritmes de previsió de series temporals. Jo crec que s’actualitza un parell o tres de vegades l’any.</p>
<p>El més interessant per a mi de l’article és aquesta taula.</p>
<p><img src="taula_historia_models_series_temporals.jpg" class="img-fluid"></p>
<p>Revisant-me en més calma la taula i rellegint l’article, vaig fixar-me amb <strong>TimeGPT</strong>.</p>
<p>Evidentment el fet de posar GPT és el que em va cridar l’atenció, i he investigat una mica més sobre TimeGPT.</p>
<p>TimeGPT és una “intel·ligència artificial” generativa però de sèries temporals de l’empresa <a href="https://www.nixtla.io/">Nixtla</a> amb seu a San Francisco.</p>
<p>TimeGPT està entrenat amb més de 100 mil milions de valors. El seu ús principal és per fer previsions i per detecció d’anomalies. Com passa amb ChatGPT, amb TimeGPT pots fer fine-tuning, és a dir, pots ajustar l’entrenament de la IA.</p>
<p>Inicialment es va construir per accedir-hi a través de Python, però ara ja hi ha disponible un paquet d’R (nixtlar).</p>
<p>No és una eina opensource. És una eina de pagament, però tenen una versió gratuïta de fins a 50 crides al mes (<a href="https://docs.nixtla.io/docs/getting-started-timegpt_subscription_plans_and_pricing">plans</a>).</p>
<p>No l’he utilitzat però sembla molt fàcil de fer servir, i segons diuen ells no cal tenir cap gran coneixement per utilitzar TimeGPT (bé com a mínim has de saber algo de python o d’R).</p>
<section id="el-meu-pla" class="level3">
<h3 class="anchored" data-anchor-id="el-meu-pla">El meu pla</h3>
<p>Fer previsió de l’atur, i potser contractació. Si m’animo potser ho provo per consum elèctric a la ciutat i a l’Ajuntament de Mataró, que són sèries horàries.</p>
</section>
<section id="com" class="level3">
<h3 class="anchored" data-anchor-id="com">Com?</h3>
<ul>
<li><p>Amb <strong>TimeGPT</strong></p></li>
<li><p>El paquet “<strong>forecast</strong>” d’R i més concretament la funció <strong>auto.arima</strong></p></li>
<li><p>Mirant d’adaptar el codi d’R d’aquest article: <a href="https://datageeek.com/2024/11/13/time-series-machine-learning-shanghai-composite/" class="uri">https://datageeek.com/2024/11/13/time-series-machine-learning-shanghai-composite/</a></p></li>
</ul>
<script type="webr-data">
eyJwYWNrYWdlcyI6eyJyZXBvcyI6W10sInBrZ3MiOlsiZXZhbHVhdGUiLCJrbml0ciIsImh0bWx0b29scyJdfSwicmVuZGVyX2RmIjoiZGVmYXVsdCIsIm9wdGlvbnMiOnsiYmFzZVVybCI6Imh0dHBzOi8vd2Vici5yLXdhc20ub3JnL3YwLjQuMS8ifX0=
</script>
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV81O1xuICBpZiAod2luZG93LkhUTUxXaWRnZXRzKSB7XG4gICAgd2luZG93LkhUTUxXaWRnZXRzLnN0YXRpY1JlbmRlcigpO1xuICB9XG4gIGlmICh3aW5kb3cuUGFnZWRUYWJsZURvYykge1xuICAgIHdpbmRvdy5QYWdlZFRhYmxlRG9jLmluaXRBbGwoKTtcbiAgfVxufVxuIiwiY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC01IiwibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0IiwiaW5saW5lIjpmYWxzZX0seyJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzUgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici01LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHdlYnItNS1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV81ID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl81LCB7fSk7XG4iLCJjZWxsTmFtZSI6IndlYnItNSIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOmZhbHNlfSx7InNvdXJjZSI6IntcbiAgLy8gV2FpdCBmb3Igb3V0cHV0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSwgdGhlbiB0cmlnZ2VyIHdpZGdldCByZW5kZXJpbmdcbiAgYXdhaXQgX3dlYnJfdmFsdWVfNDtcbiAgaWYgKHdpbmRvdy5IVE1MV2lkZ2V0cykge1xuICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTtcbiAgfVxuICBpZiAod2luZG93LlBhZ2VkVGFibGVEb2MpIHtcbiAgICB3aW5kb3cuUGFnZWRUYWJsZURvYy5pbml0QWxsKCk7XG4gIH1cbn1cbiIsImNlbGxOYW1lIjoid2Vici13aWRnZXQtNCIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsImlubGluZSI6ZmFsc2V9LHsic291cmNlIjoidmlld29mIF93ZWJyX2VkaXRvcl80ID0ge1xuICBjb25zdCB7IFdlYlJFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItNC1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGB3ZWJyLTQtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgV2ViUkV4ZXJjaXNlRWRpdG9yKHdlYlJPanMud2ViUlByb21pc2UsIGJsb2NrLmNvZGUsIG9wdGlvbnMpO1xuXG4gIHJldHVybiBlZGl0b3IuY29udGFpbmVyO1xufVxuX3dlYnJfdmFsdWVfNCA9IHdlYlJPanMucHJvY2Vzcyhfd2Vicl9lZGl0b3JfNCwge30pO1xuIiwiY2VsbE5hbWUiOiJ3ZWJyLTQiLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjpmYWxzZX0seyJzb3VyY2UiOiJ7XG4gIC8vIFdhaXQgZm9yIG91dHB1dCB0byBiZSB3cml0dGVuIHRvIHRoZSBET00sIHRoZW4gdHJpZ2dlciB3aWRnZXQgcmVuZGVyaW5nXG4gIGF3YWl0IF93ZWJyX3ZhbHVlXzM7XG4gIGlmICh3aW5kb3cuSFRNTFdpZGdldHMpIHtcbiAgICB3aW5kb3cuSFRNTFdpZGdldHMuc3RhdGljUmVuZGVyKCk7XG4gIH1cbiAgaWYgKHdpbmRvdy5QYWdlZFRhYmxlRG9jKSB7XG4gICAgd2luZG93LlBhZ2VkVGFibGVEb2MuaW5pdEFsbCgpO1xuICB9XG59XG4iLCJjZWxsTmFtZSI6IndlYnItd2lkZ2V0LTMiLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJpbmxpbmUiOmZhbHNlfSx7InNvdXJjZSI6InZpZXdvZiBfd2Vicl9lZGl0b3JfMyA9IHtcbiAgY29uc3QgeyBXZWJSRXhlcmNpc2VFZGl0b3IsIGI2NERlY29kZSB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJ3ZWJyLTMtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgd2Vici0zLWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFdlYlJFeGVyY2lzZUVkaXRvcih3ZWJST2pzLndlYlJQcm9taXNlLCBibG9jay5jb2RlLCBvcHRpb25zKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl93ZWJyX3ZhbHVlXzMgPSB3ZWJST2pzLnByb2Nlc3MoX3dlYnJfZWRpdG9yXzMsIHt9KTtcbiIsImNlbGxOYW1lIjoid2Vici0zIiwibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6ZmFsc2V9LHsic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV8yO1xuICBpZiAod2luZG93LkhUTUxXaWRnZXRzKSB7XG4gICAgd2luZG93LkhUTUxXaWRnZXRzLnN0YXRpY1JlbmRlcigpO1xuICB9XG4gIGlmICh3aW5kb3cuUGFnZWRUYWJsZURvYykge1xuICAgIHdpbmRvdy5QYWdlZFRhYmxlRG9jLmluaXRBbGwoKTtcbiAgfVxufVxuIiwiY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC0yIiwibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0IiwiaW5saW5lIjpmYWxzZX0seyJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzIgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici0yLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHdlYnItMi1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV8yID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl8yLCB7fSk7XG4iLCJjZWxsTmFtZSI6IndlYnItMiIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOmZhbHNlfSx7InNvdXJjZSI6IntcbiAgLy8gV2FpdCBmb3Igb3V0cHV0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSwgdGhlbiB0cmlnZ2VyIHdpZGdldCByZW5kZXJpbmdcbiAgYXdhaXQgX3dlYnJfdmFsdWVfMTtcbiAgaWYgKHdpbmRvdy5IVE1MV2lkZ2V0cykge1xuICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTtcbiAgfVxuICBpZiAod2luZG93LlBhZ2VkVGFibGVEb2MpIHtcbiAgICB3aW5kb3cuUGFnZWRUYWJsZURvYy5pbml0QWxsKCk7XG4gIH1cbn1cbiIsImNlbGxOYW1lIjoid2Vici13aWRnZXQtMSIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsImlubGluZSI6ZmFsc2V9LHsic291cmNlIjoidmlld29mIF93ZWJyX2VkaXRvcl8xID0ge1xuICBjb25zdCB7IFdlYlJFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItMS1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGB3ZWJyLTEtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgV2ViUkV4ZXJjaXNlRWRpdG9yKHdlYlJPanMud2ViUlByb21pc2UsIGJsb2NrLmNvZGUsIG9wdGlvbnMpO1xuXG4gIHJldHVybiBlZGl0b3IuY29udGFpbmVyO1xufVxuX3dlYnJfdmFsdWVfMSA9IHdlYlJPanMucHJvY2Vzcyhfd2Vicl9lZGl0b3JfMSwge30pO1xuIiwiY2VsbE5hbWUiOiJ3ZWJyLTEiLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjpmYWxzZX0seyJzb3VyY2UiOiJ3ZWJST2pzID0ge1xuICBjb25zdCB7IFdlYlIgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWUuV2ViUjtcbiAgY29uc3Qge1xuICAgIFdlYlJFdmFsdWF0b3IsXG4gICAgV2ViUkVudmlyb25tZW50TWFuYWdlcixcbiAgICBzZXR1cFIsXG4gICAgYjY0RGVjb2RlLFxuICAgIGNvbGxhcHNlUGF0aFxuICB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcblxuICBjb25zdCBzdGF0dXNDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImV4ZXJjaXNlLWxvYWRpbmctc3RhdHVzXCIpO1xuICBjb25zdCBpbmRpY2F0b3JDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImV4ZXJjaXNlLWxvYWRpbmctaW5kaWNhdG9yXCIpO1xuICBpbmRpY2F0b3JDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcImQtbm9uZVwiKTtcblxuICBsZXQgc3RhdHVzVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgc3RhdHVzVGV4dC5jbGFzc0xpc3QgPSBcImV4ZXJjaXNlLWxvYWRpbmctZGV0YWlsc1wiO1xuICBzdGF0dXNUZXh0ID0gc3RhdHVzQ29udGFpbmVyLmFwcGVuZENoaWxkKHN0YXR1c1RleHQpO1xuICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYEluaXRpYWxpc2VgO1xuXG4gIC8vIEhvaXN0IGluZGljYXRvciBvdXQgZnJvbSBmaW5hbCBzbGlkZSB3aGVuIHJ1bm5pbmcgdW5kZXIgcmV2ZWFsXG4gIGNvbnN0IHJldmVhbFN0YXR1cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucmV2ZWFsIC5leGVyY2lzZS1sb2FkaW5nLWluZGljYXRvclwiKTtcbiAgaWYgKHJldmVhbFN0YXR1cykge1xuICAgIHJldmVhbFN0YXR1cy5yZW1vdmUoKTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJldmVhbCA+IC5zbGlkZXNcIikuYXBwZW5kQ2hpbGQocmV2ZWFsU3RhdHVzKTtcbiAgfVxuXG4gIC8vIE1ha2UgYW55IHJldmVhbCBzbGlkZXMgd2l0aCBsaXZlIGNlbGxzIHNjcm9sbGFibGVcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5yZXZlYWwgLmV4ZXJjaXNlLWNlbGxcIikuZm9yRWFjaCgoZWwpID0+IHtcbiAgICBlbC5jbG9zZXN0KCdzZWN0aW9uLnNsaWRlJykuY2xhc3NMaXN0LmFkZChcInNjcm9sbGFibGVcIik7XG4gIH0pXG5cbiAgLy8gd2ViUiBzdXBwbGVtZW50YWwgZGF0YSBhbmQgb3B0aW9uc1xuICBjb25zdCBkYXRhQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJ3ZWJyLWRhdGFcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShiNjREZWNvZGUoZGF0YUNvbnRlbnQpKTtcblxuICAvLyBHcmFiIGxpc3Qgb2YgcmVzb3VyY2VzIHRvIGJlIGRvd25sb2FkZWRcbiAgY29uc3QgZmlsZXNDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcInZmcy1maWxlXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgZmlsZXMgPSBKU09OLnBhcnNlKGI2NERlY29kZShmaWxlc0NvbnRlbnQpKTtcblxuICAvLyBJbml0aWFsaXNlIHdlYlIgYW5kIHNldHVwIGZvciBSIGNvZGUgZXZhbHVhdGlvblxuICBsZXQgd2ViUlByb21pc2UgPSAoYXN5bmMgKHdlYlIpID0+IHtcbiAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYERvd25sb2FkaW5nIHdlYlJgO1xuICAgIGF3YWl0IHdlYlIuaW5pdCgpO1xuXG4gICAgLy8gSW5zdGFsbCBwcm92aWRlZCBsaXN0IG9mIHBhY2thZ2VzXG4gICAgLy8gRW5zdXJlIHdlYlIgZGVmYXVsdCByZXBvIGlzIGluY2x1ZGVkXG4gICAgZGF0YS5wYWNrYWdlcy5yZXBvcy5wdXNoKFwiaHR0cHM6Ly9yZXBvLnItd2FzbS5vcmdcIilcbiAgICBhd2FpdCBkYXRhLnBhY2thZ2VzLnBrZ3MubWFwKChwa2cpID0+ICgpID0+IHtcbiAgICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgRG93bmxvYWRpbmcgcGFja2FnZTogJHtwa2d9YDtcbiAgICAgIHJldHVybiB3ZWJSLmV2YWxSVm9pZChgXG4gICAgICAgIHdlYnI6Omluc3RhbGwocGtnLCByZXBvcyA9IHJlcG9zKVxuICAgICAgICBsaWJyYXJ5KHBrZywgY2hhcmFjdGVyLm9ubHkgPSBUUlVFKVxuICAgICAgYCwgeyBlbnY6IHtcbiAgICAgICAgcGtnOiBwa2csXG4gICAgICAgIHJlcG9zOiBkYXRhLnBhY2thZ2VzLnJlcG9zLFxuICAgICAgfX0pO1xuICAgIH0pLnJlZHVjZSgoY3VyLCBuZXh0KSA9PiBjdXIudGhlbihuZXh0KSwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuXG4gICAgLy8gRG93bmxvYWQgYW5kIGluc3RhbGwgcmVzb3VyY2VzXG4gICAgYXdhaXQgZmlsZXMubWFwKChmaWxlKSA9PiBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBuYW1lID0gZmlsZS5zdWJzdHJpbmcoZmlsZS5sYXN0SW5kZXhPZignLycpICsgMSk7XG4gICAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYERvd25sb2FkaW5nIHJlc291cmNlOiAke25hbWV9YDtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZmlsZSk7XG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2FuJ3QgZG93bmxvYWQgXFxgJHtmaWxlfVxcYC4gRXJyb3IgJHtyZXNwb25zZS5zdGF0dXN9OiBcIiR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1cIi5gKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5hcnJheUJ1ZmZlcigpO1xuXG4gICAgICAvLyBTdG9yZSBVUkxzIGluIHRoZSBjd2Qgd2l0aG91dCBhbnkgc3ViZGlyZWN0b3J5IHN0cnVjdHVyZVxuICAgICAgaWYgKGZpbGUuaW5jbHVkZXMoXCI6Ly9cIikpIHtcbiAgICAgICAgZmlsZSA9IG5hbWU7XG4gICAgICB9XG5cbiAgICAgIC8vIENvbGxhcHNlIGhpZ2hlciBkaXJlY3Rvcnkgc3RydWN0dXJlXG4gICAgICBmaWxlID0gY29sbGFwc2VQYXRoKGZpbGUpO1xuXG4gICAgICAvLyBDcmVhdGUgZGlyZWN0b3J5IHRyZWUsIGlnbm9yaW5nIFwiZGlyZWN0b3J5IGV4aXN0c1wiIFZGUyBlcnJvcnNcbiAgICAgIGNvbnN0IHBhcnRzID0gZmlsZS5zcGxpdCgnLycpLnNsaWNlKDAsIC0xKTtcbiAgICAgIGxldCBwYXRoID0gJyc7XG4gICAgICB3aGlsZSAocGFydHMubGVuZ3RoID4gMCkge1xuICAgICAgICBwYXRoICs9IHBhcnRzLnNoaWZ0KCkgKyAnLyc7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgd2ViUi5GUy5ta2RpcihwYXRoKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGlmICghZS5tZXNzYWdlLmluY2x1ZGVzKFwiRlMgZXJyb3JcIikpIHtcbiAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFdyaXRlIHRoaXMgZmlsZSB0byB0aGUgVkZTXG4gICAgICByZXR1cm4gYXdhaXQgd2ViUi5GUy53cml0ZUZpbGUoZmlsZSwgbmV3IFVpbnQ4QXJyYXkoZGF0YSkpO1xuICAgIH0pLnJlZHVjZSgoY3VyLCBuZXh0KSA9PiBjdXIudGhlbihuZXh0KSwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuXG4gICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBJbnN0YWxsaW5nIHdlYlIgc2hpbXNgO1xuICAgIGF3YWl0IHdlYlIuZXZhbFJWb2lkKGB3ZWJyOjpzaGltX2luc3RhbGwoKWApO1xuXG4gICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBXZWJSIGVudmlyb25tZW50IHNldHVwYDtcbiAgICBhd2FpdCBzZXR1cFIod2ViUiwgZGF0YSk7XG5cbiAgICBzdGF0dXNUZXh0LnJlbW92ZSgpO1xuICAgIGlmIChzdGF0dXNDb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoID09IDApIHtcbiAgICAgIHN0YXR1c0NvbnRhaW5lci5wYXJlbnROb2RlLnJlbW92ZSgpO1xuICAgIH1cbiAgICByZXR1cm4gd2ViUjtcbiAgfSkobmV3IFdlYlIoZGF0YS5vcHRpb25zKSk7XG5cbiAgLy8gS2VlcCB0cmFjayBvZiBpbml0aWFsIE9KUyBibG9jayByZW5kZXJcbiAgY29uc3QgcmVuZGVyZWRPanMgPSB7fTtcblxuICBjb25zdCBwcm9jZXNzID0gYXN5bmMgKGNvbnRleHQsIGlucHV0cykgPT4ge1xuICAgIGNvbnN0IHdlYlIgPSBhd2FpdCB3ZWJSUHJvbWlzZTtcbiAgICBjb25zdCBldmFsdWF0b3IgPSBuZXcgV2ViUkV2YWx1YXRvcih3ZWJSLCBjb250ZXh0KVxuICAgIGF3YWl0IGV2YWx1YXRvci5wcm9jZXNzKGlucHV0cyk7XG4gICAgcmV0dXJuIGV2YWx1YXRvci5jb250YWluZXI7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHByb2Nlc3MsXG4gICAgd2ViUlByb21pc2UsXG4gICAgcmVuZGVyZWRPanMsXG4gIH07XG59XG4iLCJjZWxsTmFtZSI6IndlYnItcHJlbHVkZSIsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsImlubGluZSI6ZmFsc2V9XX0=
</script>
<div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
W10=
</script>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../..";
window._ojs.paths.runtimeToRoot = "../../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiat!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiat!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>